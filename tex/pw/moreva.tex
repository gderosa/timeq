\section{Experimental illustration}
\label{sec:pw:qubit}\label{sec:pw:apps_first}

\subsection{Review}

The Page and Wootters model has been illustrated experimentally in recent years,
with a very simple toy universe consisting of just two qubits
---physically, the polarization states,
vertical $\ket{H}$ or horizontal $\ket{V}$,
of two photons \parencite{Moreva:synthetic,Moreva:illustration}.
A first qubit implements the clock, the second qubit acts as ``the system'' (or
``the rest of the universe'').

In another experiment by the same authors \parencite{Moreva_position}, $\hilb{H}_S$ is still
implemented with 
polarization states $\ket{H}$ or $\ket{V}$ of a photon, but the clock states in $\hilb{H}_T$
are given by the \emph{position} of the same photon along the conventional $x$ axis.

The latter is interesting because it implements a continuous time,
which, among other things, allows identifying a canonically conjugate observable
$\op{\Omega}$. Or, conversely, a time operator $\op{T}$, once $\op{\Omega}$ is given
(as shown in Sec. \ref{sec:finite_uncertainty}, it is impossible to satisfy \eqref{eq:canonical_commutation_in_time}
in a finite-dimension Hilbert space).

On the other hand, one problematic aspect of the experiment with continuous time
is that
it relies on \term{photon position} which is another
still controversial topic (see, for example, \cite{HawtonPhotonPosition}),
similar, in that regards, to the quest for a quantum time operator that the experiment is trying to solve.

%%  Was asked to remove this:
% Just like time in quantum mechanics, position coordinates in quantum optics and other field theories
% are (classical) external parameters and not quantum observables.

%%  Also, this was deemed unclear... Not sure I have time to study this in more details and explain more...
% However, the experiment in \cite{Moreva_position} verifies the violation of
% \term{Legget-Garg inequalities}, as previously suggested in \cite{LeggettGarg+PageWootters},
% for ``time'' measurement results
% (In our notation, Leggett-Garg inequalities are to $\hilb{H}_T$ what the well known Bell inequalities
%   are to $\hilb{H}_S$).
% This proves the ``quantumness'' of this realization of Page and Wootters time,
% regardless of the explicit expression of the corresponding operator (which, unsurprisingly,
% is not given). It's tempting to infer that the experiment
% rather tests Bell/Leggett-Garg inequalities for photon position.

The first experiment, on the other hand \parencite{Moreva:illustration,Moreva:synthetic},
uses (uncontroversial)
two-level quantum systems for both the clock and the rest of the universe.
While we cannot derive a $\op{T}$ such that $[\op{T}, \op{\Omega}] = i$
because of the finite dimension of the space $\hilb{H}_T$, both $\op{\Omega}$
and $\op{H}_S$ are given an explicit expression:
\begin{align}
  \op{\Omega}            &= i\omega(\ketbra{H}{V}- \ketbra{V}{H})_T \label{eq:MorevaOmegaT}\\
  \op{H}_S/{\hbar}       &= i\omega(\ketbra{H}{V}- \ketbra{V}{H})_S \label{eq:MorevaH_S}
  \,\text{,}
\end{align}
as well as a zero-eigenstate of $\op{\mathbb{J}}$ (as in eq. \ref{eq:pwHamiltonian}):
\begin{equation}\label{eq:moreva:overall_state}
  \dket{\Psi} = \frac{1}{\sqrt{2}}\qty(\ket{H}_T\ket{V}_S-\ket{V}_T\ket{H}_S)
  \,\text{.}
\end{equation}

It can be easily verified that the Wheeler-DeWitt condition
\eqref{eq:Wheeler-DeWitt} is satisfied.

In general, given a clock ($\op{\Omega}$), the problem of finding a
``rest of the universe'' ($\op{H}_S$) such that
$\hbar\op{\Omega}\ox\idop_S + \idop_T\ox\op{H}_S = 0$
(and vice versa)
is not trivial
(and it's particularly cumbersome in non-relativistic
quantum mechanics where we can't avail of negative energies etc.).
Most literature focuses their examples on clocks only
\parencite{Prvanovic,RealisticClocks,HarmonicClocks},
implicitly relying on the scale of a realistic universe
in order to have the \eqref{eq:Wheeler-DeWitt} satisfied
(which was originally derived using General Relativity arguments).
% but missing the opportunity to illustrate the entanglement mechanism in detail,
% which is aimed at, instead, in the present work, to some extent.

\subsection{Analysis}

\subsubsection*{Page--Wootters history vector $\dket{\Psi}$, in terms of polarization eigenstates}

See Eq.~\eqref{eq:moreva:overall_state}.

\subsubsection*{Hamiltonians in $\hilb{H}_T$ and $\hilb{H}_S$}

See Eq.~\eqref{eq:MorevaOmegaT} and \eqref{eq:MorevaH_S}.

\subsubsection*{Verification of the Wheeler--DeWitt condition}

\begin{multline}\label{eq:pw:moreva:WheelerDeWittVerification}
  \op{\mathbb{J}} \dket{\Psi} 
  \repr[\setof{H, V}] 
  \frac{\hbar\omega}{\sqrt{2}}
  \left( 
    \left[\begin{matrix}0 & i\\- i & 0\end{matrix}\right]
    \ox
    \idop
    +
    \idop
    \ox
    \left[\begin{matrix}0 & i\\- i & 0\end{matrix}\right]
  \right)
  \left(
    \left[\begin{matrix}1\\0\end{matrix}\right] \ox \left[\begin{matrix}0\\1\end{matrix}\right]
    -
    \left[\begin{matrix}0\\1\end{matrix}\right] \ox \left[\begin{matrix}1\\0\end{matrix}\right] 
  \right)
  \\
  =
  \frac{\hbar\omega}{\sqrt{2}}
  \left(
    \left[\begin{matrix}  &   & i & 0\\  &   & 0 & i\\- i & 0 &   &  \\0 & - i &   &  \end{matrix}\right]
    +
    \left[\begin{matrix}0 & i &   &  \\- i & 0 &   &  \\  &   & 0 & i\\  &   & - i & 0\end{matrix}\right]
  \right)
  \mqty[0 \\ 1 \\ -1 \\ 0]
  =
  \mqty[0 \\ 0 \\ 0 \\ 0]
  \text{.}
  \qed
\end{multline}

\subsubsection*{Eigenvalues and eigenvectors of $\op{H}_T$}

Diagonalizing the matrix $\frac{\hbar\omega}{\sqrt{2}}\mqty[0 &i\\-i &0]$,
representing $\op{H}_T = \hbar\op{\Omega}$ in the photon polarization basis,
one easily finds the eigenvalues $\mp\hbar\omega$ and the corresponding eigenbasis 
$\setof{\mp i \ket{H} + \ket{V}}_T$.

\subsubsection*{Change to $H_T$ representation}

The Page--Wootters history vector $\dket{\Psi}$ is expressed in Eq.~\eqref{eq:moreva:overall_state}
in terms of the polarization eigenstates. In matrix form ---see also Eq.~\eqref{eq:pw:moreva:WheelerDeWittVerification}:
\begin{equation}
  \dket{\Psi} \repr[\setof{H, V}] \mqty[0 \\ 1 \\ -1 \\ 0] \text{.}
\end{equation}
Elements of this column vector are the components of $\dket{\Psi}$
with respect to the basis $\setof{\ket{H}, \ket{V}}_T \ox \setof{\ket{H}, \ket{V}}_S$.

To facilitate a comparison of the the Page--Wootters history with standard quantum mechanics time evolution,
we must compute the components of $\dket{\Psi}$ with respect to an eigenbasis of the Time operator
---or, more correctly, the tensor product of the Time eigenbasis in $\hilb{H}_T$,
and the (``familiar'') polarization basis in $\hilb{H}_S$: $\setof{\ket{t_0}, \ket{t_1}}_T \ox \setof{\ket{H}, \ket{V}}_S$.

Also, if the lowest eigenvalues of $\op{\Omega}$ (or $\op{T}$) is not zero,
the shift property, Eq.~\eqref{eq:IDFT:chrepr:tshift}, or Eq.~\eqref{eq:DFT:chrepr:tshift},
must be taken into account.  

\subsubsection*{Clock frequency (or energy) resolution}

\begin{lstlisting}[language=Python]
delta_HT = abs(HT_HT[1,1] - HT_HT[0,0])
\end{lstlisting}

\subsubsection*{Time operator in clock frequency (or energy) eigenbasis}

\begin{lstlisting}[language=Python]
T_HT = (pi / (delta_HT**2)) * F @ HT_HT @ Dagger(F) 

T_HT
\end{lstlisting}
$$
  \left[\begin{matrix}0 & - \frac{\pi}{4}\\- \frac{\pi}{4} & 0\end{matrix}\right]
$$
\begin{lstlisting}[language=Python]
eigenvals_T = list(T_HT.eigenvals().keys())

eigenvals_T.sort()
\end{lstlisting}

\subsubsection*{Time resolution of the clock (difference between contiguous eigenvalues)}

\begin{lstlisting}[language=Python]
delta_T = eigenvals_T[1] - eigenvals_T[0]
\end{lstlisting}

\subsubsection*{(Double) change of basis}

HERE Symbols
\begin{equation}
\op{S}^{\dagger}\op{F}^{\dagger}\op{U}^{\dagger}
\end{equation}

\begin{equation}
  \hat{\mathcal{S}}_{\omega_0}^{\dagger} \hat{F}^{\dagger} \hat{\mathcal{E}}_{\Omega}^{\dagger}
\end{equation}

Now, the $U^{\dagger}$ matrix translates components \emph{from Polarization into Energy/Frequency} eigenbasis representation
in the clock space $\hilb{H}_T$.

The (inverse) Fourier $F^{\dagger}$ does the same \emph{from Energy/Frequency into Time}.

As we are operating in the product space, we need the tensor product by $\idop$ in the ``system'' space $\mathcal{H}_S$.

\subsubsection*{Correction term due to $\omega_0 \neq 0$ (frequency shift of Fourier transform)}

See Eq.~\eqref{eq:IDFT:chrepr:tshift}:
\begin{equation}
  \langle{t_{m}}|{\psi}\rangle = e^{i\omega_{0}t_m} \sum_n F^{\dagger}_{mn} \langle{\omega_n}|{\psi}\rangle \text{.}
\end{equation}

Shift term: $e^{i\omega_{0}t_m} \text{,} \; \forall m = 0, 1$.

\begin{lstlisting}[language=Python]
omega_0 = eigenvalues_H_T[0]

shift = list(map(lambda t_m: exp(t_m * omega_0 * I), eigenvals_T))

# matrix form
Shift = diag(*shift)

Shift
\end{lstlisting}
$$
  \left[\begin{matrix}e^{\frac{i \pi}{4}} & 0\\0 & e^{- \frac{i \pi}{4}}\end{matrix}\right]
$$

\begin{lstlisting}[language=Python]
UU = TensorProduct(Shift @ Dagger(F) @ Dagger(U), eye(2))

UU
\end{lstlisting}
$$
  \left[\begin{matrix}0 & 0 & e^{\frac{i \pi}{4}} & 0\\0 & 0 & 0 & e^{\frac{i \pi}{4}}\\i e^{- \frac{i \pi}{4}} & 0 & 0 & 0\\0 & i e^{- \frac{i \pi}{4}} & 0 & 0\end{matrix}\right]
$$

\begin{lstlisting}[language=Python]
Psi_t = UU @ Psi_hv
\end{lstlisting}

\subsubsection*{Page--Wootters history vector in time $\otimes$ polarization basis}

\begin{lstlisting}[language=Python]
psi_0 = Matrix(Psi_t[0:2])
psi_1 = Matrix(Psi_t[2:])

psi_0 = psi_0 / psi_0.norm()
psi_1 = psi_0 / psi_1.norm()
\end{lstlisting}

\pagebreak\subsubsection*{``Initial'' and ``evolved'' normalized states extracted from the components of the Page--Wootters history vector $\dket{\Psi}$}

\begin{lstlisting}[language=Python]
psi_0
\end{lstlisting}
$$
  \left[\begin{matrix}- e^{\frac{i \pi}{4}}\\0\end{matrix}\right]
$$
\begin{lstlisting}[language=Python]
psi_1
\end{lstlisting}
$$
  \left[\begin{matrix}0\\i e^{- \frac{i \pi}{4}}\end{matrix}\right]
$$

\subsubsection*{Time evolution in standard quantum mechanics (for comparison)}

\begin{lstlisting}[language=Python]
U_evol = exp(-I*HS_hv*delta_T)

evolved_Schrod = U_evol @ psi_0

evolved_PW = psi_1

evolved_Schrod
\end{lstlisting}
$$
  \left[\begin{matrix}0\\e^{\frac{i \pi}{4}}\end{matrix}\right]
$$
\begin{lstlisting}[language=Python]
evolved_PW
\end{lstlisting}
$$
  \left[\begin{matrix}0\\i e^{- \frac{i \pi}{4}}\end{matrix}\right]
$$
Thanks to the shift term (``\verb|Shift|'')
(and simply recalling that $i=e^{\frac{i\pi}{2}}$),
it is seen that
results from the two theories coincide.
\begin{lstlisting}[language=Python]
simplify(evolved_Schrod - evolved_PW)
\end{lstlisting}
$$
  \left[\begin{matrix}0\\0\end{matrix}\right] \, \text{.} \; \qed
$$

\subsubsection*{Notebook}

See Appendix \ref{sec:moreva:shit_Fourier}, where it is set $\hbar = \omega = 1$, hence $\hat{H}_T = \hat{\Omega}$.
Also TODO map symbols re change of basis unitary matrices\dots