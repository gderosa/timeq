\documentclass[a4paper,12pt]{book}

% It is mentioned in more than one place, so better DRY
\newcommand{\thetitle}{Time in Quantum Mechanics and the Page--Wootters Formalism}

\usepackage[svgnames]{xcolor}
\usepackage{lipsum}  %% dev
\usepackage{dpfloat}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{amsthm}
\usepackage{mathrsfs}
\usepackage{xparse}  %% required by physics
\usepackage{physics}
\usepackage{breqn}
\usepackage{bbm}
\usepackage[utf8]{inputenc}
\usepackage{mathtools}
\usepackage[super]{nth}
\usepackage[inline]{enumitem}
\usepackage{graphicx}
\usepackage{subcaption} % https://tex.stackexchange.com/a/43996 + https://tex.stackexchange.com/a/165730
  \captionsetup{subrefformat=parens}
\usepackage{color}

\usepackage[a4paper,lmargin=4cm]{geometry}

\usepackage{multirow}
\usepackage{fancyhdr}
\pagestyle{fancy}  %% prevent long section titles from overflowing page headers
  \fancyhf{}
  \fancyhead[LE]{\thepage}
  \fancyhead[RE]{\textit{\nouppercase{\leftmark}}}
  \fancyhead[LO]{\textit{\nouppercase{\rightmark}}}
  \fancyhead[RO]{\thepage}
\fancypagestyle{nomark}{%
  \fancyhf{}
  \fancyhead[LE]{\thepage}
  \fancyhead[RE]{}
  \fancyhead[LO]{}
  \fancyhead[RO]{\thepage}
}
\setlength{\headheight}{14.5pt}  %% prevent fancyhead Warning.

% https://tex.stackexchange.com/a/1557
% https://tex.stackexchange.com/a/176939
\usepackage[safeinputenc,style=authoryear-icomp,mincitenames=1,maxcitenames=2,uniquelist=minyear,maxbibnames=7,backend=biber]{biblatex}
%\usepackage[safeinputenc,uniquelist=minyear,maxbibnames=7,backend=biber]{biblatex}
\usepackage{environ}
\usepackage{csquotes}
\usepackage{epigraph}
  \setlength{\epigraphwidth}{.66\textwidth}
  \renewcommand{\epigraphsize}{\small}
  \setlength{\epigraphrule}{0.005pt}
  \setlength{\beforeepigraphskip}{.8\baselineskip}
  \setlength{\afterepigraphskip}{1.2\baselineskip}
\usepackage{fancyvrb}
  \fvset{
    frame = single,
    rulecolor=\color{lightgray}
  }
\usepackage{footnote}
%
% Ways to avoid "random" vertical space between paragraphs
% https://tex.stackexchange.com/a/36429
\raggedbottom
\usepackage[bottom]{footmisc}
%
\usepackage{listings}
  \lstset{
    frame = single,
    rulecolor=\color{lightgray},
    basicstyle=\setstretch{1.2}\scriptsize\ttfamily,
    commentstyle=\color{gray},
    keywordstyle=\color{blue},
    stringstyle=\color{red},
    fancyvrb=true,
    breaklines=true,
    aboveskip=1.1em,
    belowskip=0.4em,
    %identifierstyle=\color{green!40!black}
  }
\usepackage{setspace}
\usepackage{etoolbox}
\usepackage[  %% be (almost) the last -- https://tex.stackexchange.com/a/326953
  %% pdfusetitle would not render the ket <1| correctly -- title is a plain text
  %% pdftitle={It's |1> o'clock -- Relational Time and Applications},
  %% "problem solved" due to a more "formal" title requested:
  pdftitle={\thetitle},
  colorlinks
]{hyperref}
  \hypersetup{
    linkcolor = DarkRed,
    citecolor = Green,
    urlcolor  = DarkBlue
  }

% https://tex.stackexchange.com/a/65547
\usepackage{bookmark}

% "dev only"
\ifdev
  % \usepackage[breakable,skins]{tcolorbox}
  % \definecolor{tcbcolback} {HTML}{EEEEFF}
  % \definecolor{tcbcolframe}{HTML}{4444BB}
  % \tcbset{
  %   colback=tcbcolback, colframe=tcbcolframe,
  %   breakable, enhanced jigsaw,
  %   parbox=false, before upper={%
  %     \setlength{\parskip}{0.666em}%
  %     \setlength{\parindent}{0pt}%
  %     \setstretch{1.2}%
  %   }
  % }

  \usepackage[xcolor,outerbars]{changebar}
  \cbcolor{magenta}
  \setlength{\changebarsep}{1em}

  % https://tex.stackexchange.com/a/53252
  \pdfcompresslevel=0
  \pdfobjcompresslevel=0
\fi

\input{tex/lib}

\renewcommand{\arraystretch}{1.6}

% https://tex.stackexchange.com/a/325704
\AtBeginEnvironment{quote}{\singlespace\vspace{-\topsep}}
\AtEndEnvironment{quote}{\vspace{-\topsep}\endsinglespace}

\author{Guido De Rosa \\ \small\tt{gderosa@umail.ucc.ie}}
\title{\thetitle}

\addbibresource{bib/main.bib}
\addbibresource{bib/comp.bib}
\addbibresource{bib/misc.bib}
% For peer-reviewed articles, in general there is a DOI which is detailed enough,
% while only some entries have issn fields, essentially out of a copypaste -
% See also https://tex.stackexchange.com/a/32933.
\AtEveryBibitem{
  \clearfield{issn}
  \clearfield{month}
}
