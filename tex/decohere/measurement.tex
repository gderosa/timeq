\section{Standard measurement and generalizations}

The evolution of the density operator for a closed system is given by the map
\[
    \rho_{S} \rightarrow \mathcal{E}(\rho_{S}) = U(t)\rho_{S}U^{\dagger}(t) \, \text{.}
\] 
We are looking to describe a more general change
$\rho \rightarrow \mathcal{E}(\rho_{S})$ that may also include
changes due to measurement (or noise).

Furthermore, we are looking to describe a generalization
of projective measurement~\parencite{VonNeumann}:
when a projective, Von-Neumann
measurement is performed on a multipartite system,
it does not necessarily correspond to a projective measurement
on each subsystem~\parencite[Ch. 3]{PreskillNotes}.

\subsection{Review on projectors}

We shall assume, unless otherwise stated, that all vectors are
normalized to unity.

Consider an observable represented by a self-adjoint operator $A$
with a 
\emph{discrete, non degenerate spectrum}.
Let $a_i$ by an eigenvalue of $A$, and $\ket{i}$ its corresponding eigenvector.
The probability of a measurement
outcome $a_i$,
on a system in the pure state $\ket{\psi}$
is given by
$$
\pi_{i} = \norm{\braket{i}{\psi}}^2
        = \bra{\psi}\ket{i}\bra{i}\ket{\psi}
        = \mel{\psi}{P_{i}}{\psi}
$$
where $P_{i} = \ketbra{i}$ appears as the \term{projector} on the
one-dimensional ei\-gen\-space related to eigenvalue  $a_i$.

If $a_i$ is degenerate, $j = 1, \dots, J$ its degeneracy index, and $\ket{ij}$ the corresponding eigenvectors,
such probability shall sum over it:
$$
\pi_{i} = \sum_{j=1}^{J}\norm{\braket{ij}{\psi}}^2
        = \sum_{j=1}^{J}\bra{\psi}\ket{ij}\bra{ij}\ket{\psi}
        = \mel{\psi}{P_{i}}{\psi}
$$
where $P_{i} = \sum_{j=1}^{J}\ketbra{ij}$
still is the projector on the
($J$-dimensional) eigenspace of $a_i$.

Generally, the probability that the outcome of a measuremen falls in
the set of eigenvalues $\sigma = \{a_{1}, \dots, a_{S}\}$ is
\begin{equation}\label{eq:pi_sigma}
\pi_{\sigma}  = \sum_{i=1}^{S}\sum_{j=1}^{J_{i}}\norm{\braket{ij}{\psi}}^2
              = \sum_{i=1}^{S}\sum_{j=1}^{J_{i}}\bra{\psi}\ket{ij}\bra{ij}\ket{\psi}
              = \mel{\psi}{P_{\sigma}}{\psi}
              ,
\end{equation}
where $P_{\sigma} = \sum_{i=1}^{S}\sum_{j=1}^{J_{i}}\ketbra{ij}$
is once again a projector --- on the ``generalized eigenspace'' spanned by all
eigenvectors $\{\ket{ij}\}$ above.

Looking back at eq.~\eqref{eq:expvalA_rho},
it is valid for \emph{any} Hermitean operator,
therefore it is also valid for projectors.
Hence we can replace $A$ with the projector $P_{\sigma}$,
associated to the set of eigenvalues $\sigma$
according to \eqref{eq:pi_sigma} and \eqref{eq:P_sigma_spectral}.

This is of particular interest
because its mean value equates the probability that the outcome of a measurement
falls in a given subset of the spectrum of a given observable.
So we have:

\begin{proposition}\label{probability_rho}
  The probability $\pi_{\sigma}$
  that the outcome of a measurement of the observable $A$
  on the system described by the state operator $\rho$
  falls in the set $\sigma$
  is given by:
  \begin{equation}\label{eq:probability_rho}
    \pi_{\sigma} = \expval{P_{\sigma}} = \tr(P_{\sigma}\rho)
  \end{equation}
  with $P_{\sigma}$ defined as in \eqref{eq:pi_sigma}
  or, more generally, in \eqref{eq:P_sigma_spectral}.
\end{proposition}

Being $\pi_{\sigma}$ the \emph{probability} of the outcome of a measurement to
fall in a given set $\sigma$, it has to be:
\begin{enumerate}
  \item \label{measure_properties:first} $0$ on the empty set
  \item non negative
  \item \label{measure_properties:last} \term{additive} on disjoint sets
  \item \label{measure_properties:normalized} equal to $1$ if $\sigma$ includes the whole spectrum of $A$.
\end{enumerate}

Properties \ref{measure_properties:first}\dots\ref{measure_properties:last}
are the defining properties of a \term{measure}\footnote{
  Not to be confused with \emph{measurement}.
} \parencite{EncMath_Measure},
and
the map $\sigma \subseteq \mathbb{R} \rightarrow P_{\sigma}$
implicitly defined in~\eqref{eq:pi_sigma} is a \term{projector-valued measure}.

This notion of projector-valued measure can be generalized
in such a way to include both the cases of discrete and continous spectra,
with the following \parencite{VonNeumann, Ballentine}
\begin{theorem}[spectral resolution]
  If $A$ is a self-adjoint operator,
  there is a unique projector-valued measure $E$
  defined on the Borel sets of $\mathbb{R}$
  such that
  \footnote{
    In \eqref{eq:spectral}, $a$ is a real number (not a set),
    but it's intended $E$ to be evaluated
    on the~\emph{interval}~from $-\infty$ to $a$.
  }
  \begin{equation}\label{eq:spectral}
    A=\int_{-\infty}^{\infty}a\, dE(a)
  \end{equation}
  and satisfying:
  \begin{align*}
    E(\mathbb{R})       & =\mathbf{1},\\
    E(B_{1}\cap B_{2}) & =E(B_{1})E(B_{2})\,.
  \end{align*}
\end{theorem}

In terms of this theorem, the projector in \eqref{eq:pi_sigma} is
\begin{equation}\label{eq:P_sigma_spectral}
  P_{\sigma} = E(\sigma) = \int_{a\in\sigma}dE(a)
\end{equation}
and $dE(a)$ is
---informally speaking---
infinitesimal if $a$ belongs to the continous spectrum,
finite if $a$ is a discrete eigenvalue
and zero otherwise.


\subsection{Projective measurement}

Let $\hilb{H}_A$ and $\hilb{H}_B$ be the Hilbert spaces describing
a system under measurement and the measurement device respectively.
For simplicty, let both have finite di\-mension~$N$.
Let $\ket{\Psi}, \ket{\Psi'} \in \hilb{H}_{A} \ox \hilb{H}_{B}$
be the overall state of the
system \emph{plus} measurement apparatus, 
respectively before and after the measurement.

Let us also consider a \term{complete}, \term{orthogonal} set of $N$ projectors
$P_0 \dots P_{N-1}$ on the Hilbert space $\hilb{H}_A$,
i.e. the projectors have the properties
\begin{align}
  \sum_n P_n  &= \idop \text{,}\\
  P_i P_j     &= \delta_{ij}P_i \, \text{.}
\end{align}

On $\hilb{H}_B$ instead, describing the measurement device, let's consider
the
% fiducial\footnote{
%   In the sense that it's assumed
%   that we can arbitrarily ``reset'' (prepare) the device,
%   for example at state $\ket{0}$,
%   and in general
%   we will find the device at one of the states
%   $\ket{0}\dots\ket{N-1}$
%   when we observe it (\term{pointer states}).
%   Therefore, what follows \emph{is not} a derivation of the Born's rule,
%   which is still a necessary postulate of quantum mechanics
%   (only \cite{Zurek_Decoherence, Zurek_Einselect, Zurek_Fundamentals} push
%   this point of view further). In other words, the Born rule for the system
%   will be ``proved''
%   only on the assumption that it is valid for the measurement apparatus already.
% }
basis:
\begin{equation}\label{eq:qmt:fiducial_basis_N}
  \setof{\ket{0} \dots \ket{N-1}} \text{.}
\end{equation}

The coupling between the system and the apparatus
can be modelled by
a unitary operator
transforming the state of system and apparatus before and after the measurement.
The following is a possible
example \parencite[sec. 3.1.1 ``Orthogonal Measurements'']{PreskillNotes}:

\begin{equation}\label{eq:unitary_measurement}
  U = \sum_{a, b = 0}^{N-1} P_a \ox \ketbra{b+a}{b} \text{,}
\end{equation}
where 
$\ket{b+a}$ and $\bra{b}$ are all elements of the basis \eqref{eq:qmt:fiducial_basis_N}
and
the sum $b+a$ is \emph{modulo N}:
intuitively, if the $a$-th eigenvalue of the observable is measured,
a sort of ``circular dial''
on the measurement device rotates of $a$ positions.

If the system and the measurement device are initially in the
state $\ket{\psi}$~and~$\ket{0}$ respectively
(therefore $\ket{\Psi} = \ket{\psi} \ox \ket{0}$),
using the eq.~\eqref{eq:unitary_measurement},
the state after the measurement will be %
%
\begin{equation}\label{eq:explicit_measurement_evolution}
  \ket{\Psi^{\prime}} = U(\Psi) = U\Big(\ket{\psi} \ox \ket{0}\Big) =
    \sum_{a, b} P_a \ox \ketbra{b+a}{b} \big(\ket{\psi} \ox \ket{0}\big)
    \text{.}
\end{equation}
Indeed, in eq. \eqref{eq:explicit_measurement_evolution}, only terms with $b=0$ survive.
Therefore
\begin{eqsplit}\label{eq:measurement_entangled}
  \ket{\Psi^{\prime}} &= \sum_a \qty\Big(P_a\ox\ketbra{a}{0}) \qty\Big(\ket{\psi}\ox\ket{0}) \\
                      &= \sum_a P_a \ket{\psi} \ox \ket{a}
\end{eqsplit}

The probability of an outcome $a$ is
\begin{multline}\label{eq:measurement_probability}
  \pi_{a} = \expval{\qty\Big(\idop\ox\ketbra{a})}{\Psi^{\prime}} = \\
    \sum_{b,c}
      \qty(\bra{\psi}P_{b}\ox\bra{b})
      \qty\Big(\idop\ox\ketbra{a})
      \qty(P_{c}\ket{\psi}\ox\ket{c}) = \\
    \sum_{b,c}\qty\Big(\expval{P_bP_c}{\psi} \braket{b}{a} \braket{a}{c}) =
    \expval{P_a}{\psi} \text{.}
\end{multline}

Eq. \eqref{eq:measurement_entangled} clearly shows that the system
and the measurement device are completely correlated (entangled).
If the measurement apparatus is observed in state $\ket{a}$
---with probability $\pi_{a}$ as stated in eq.~\eqref{eq:measurement_probability}---
then the system being measured is in state $P_{a}\ket{\psi}$
or, in normalized form:
\begin{equation}\label{eq:normalized_collapse}
  \ket{\psi^\prime_a} \eqbydef \frac{P_{a}\ket{\psi}}{\norm{P_{a}\ket{\psi}}}
    = \frac{P_{a}\ket{\psi}}{\sqrt{\expval{P_a}{\psi}}} \,\text{.}
\end{equation}

Indeed,
$\ket{\psi}$
is transformed
into its projection $\ket{\psi^\prime_a}$
onto the eigenspace
corresponding to the eigenvalue $a$ of the observable of interest.

Please note the above \emph{is not} a derivation of the Born (probability) rule altogether,
as it still needs to be postulated for the measurement apparatus.

Finally, if the measurement apparatus is not observed,
therefore an outcome $a$ is not known,
the system \emph{after} measurement is in a statistical mixture
of ``all possible wavefunction collapses'' weighted on the probability $\pi_{a}$.
By using both \eqref{eq:measurement_probability} and \eqref{eq:normalized_collapse},
and the definition of the density operator for the initial pure state
$\rho = \ketbra{\psi}$:
\[
  \rho^{\prime} = \sum_a \Pr(a) \ketbra{\psi^{\prime}_a} = \sum_a P_a \ketbra{\psi} P_a
    = \sum_a P_a \rho P_a \,\text{.}
\]
So, the initial pure state $\rho$ is transformed by the measurement process into a mixed one.
In other words, the initial, coherent superposition of eigenstates represented by $\rho = \ketbra{\psi}$
becomes a maximal statistical mixture $\rho^{\prime}$
(as seen in Section \ref{sec:mix}).

It can be proven that the transformation
\begin{equation}\label{eq:irreversible_measurement}
  \rho \rightarrow \sum_a P_a \rho P_a
\end{equation}
is also valid in the more general case of $\rho$ being a mixed state before the measurement
---in this case, it's transformed into another mixed state,
but still described by the \eqref{eq:irreversible_measurement}.
A generalization to observables with a continuous spectrum is also possible
(see e.g. \cite[Section 3.1.1]{PreskillNotes} for more details).


\subsection{Generalized measurement (POVM)}
\label{subsec:POVM}

Let's start considering, for simplicity, a 2-level system,
the corresponding 2-level pointer space,
and the unitary transformation describing the measurement process:
\begin{multline}\label{eq:qubit_ortho_measurement}
  U:
    \ket{\psi}_A \ox \ket{0}_B
    = \qty\big{\alpha\ket{0}_A + \beta\ket{1}_A} \ox \ket{0}_B
  \rightarrow \\
    \alpha\ket{0}_A \ox \ket{0}_B + \beta\ket{1}_A  \ox \ket{1}_B =
    \:
    E_0\ket{\psi}_A \ox \ket{0}_B + E_1\ket{\psi}_A \ox \ket{1}_B
\end{multline}
with subscripts $A$ and $B$ designating the system of interest and
the measurement apparatus (pointer space) respectively.

When we observe the pointer, let's assume we're not
able to ``measure'' it with respect to the fiducial basis
$\setof{\ket{0}, \ket{1}}$,
but with respect to another basis, say,
\begin{equation}\label{eq:pmbasis}
\setof{\ket{\pm} = \frac{1}{\sqrt{2}} \qty\Big(\ket{0}_B \pm \ket{1}_B)} \,\text{.}
\end{equation}

We can rewrite \eqref{eq:qubit_ortho_measurement} as
\begin{multline}\label{eq:qubit_gen_measurement}
  U: \ket{\psi}_A \ox \ket{0}_B                   \rightarrow \\
  \frac{1}{\sqrt{2}} \qty\Big(
    \alpha\ket{0}_A \ox \qty(\ket{+}+\ket{-}) +
    \beta \ket{1}_A \ox \qty(\ket{+}-\ket{-})
  )                                               =           \\
  \frac{1}{\sqrt{2}} \qty\Big(
    \qty(\alpha\ket{0}_A + \beta\ket{1}_A) \ox \ket{+} +
    \qty(\alpha\ket{0}_A - \beta\ket{1}_A) \ox \ket{-}
  )                                               \eqbydef      \\
  M_+\ket{\psi}_A \ox \ket{+} + M_-\ket{\psi}_A \ox \ket{-}
  \,\text{,}
\end{multline}
where we have defined:
\begin{align*}
  &
  M_+ \repr \frac{1}{\sqrt{2}}\mqty(\imat{2})
  &
  M_- \repr \frac{1}{\sqrt{2}}\mqty(1& 0\\0& -1)
\end{align*}
with respect to the basis $\setof{\ket{0}_A, \ket{1}_A}$.

After measurement, system $A$ is ``prepared''
(up to a normalization factor)
in one of the states $M_{\pm}\ket{\psi}$,
that are not necessarily orthogonal.

Moreover, $M_+$ and $M_-$ are not generally idempotent,
therefore if we repeat the measurement we don't generally
obtain the same result (and don't leave the system $A$ in the same state).
This is a fundamental difference with projective measurement.

Besides this particular example, $M_+$ and $M_-$ are not even necessarily
self-adjoint, and we can see that, while $M$ generalise the projector $P$
in terms of ``collapsing'' (or ``preparing'') the system under measurement,
in some sense a better generalization is in fact $M^{\dagger}M$\footnote{
  Such distinction is inessential for a projector $P$,
  as $P^{\dagger}P = P^2 = P$.
}, particularly in the sense of \term{decomposition of the identity}:
$\sum_a M_a^{\dagger}M_a = \idop$ \parencite[sec.3.1]{PreskillNotes}.

The example of $\ket{\pm}$ is a particularly ``unsharp'' measurement,
or a particularly ``overlapping'' decomposition of the identity,
because
$$M_+^{\dagger}M_+ = M_-^{\dagger}M_- = \frac{1}{2}\idop\text{.}$$

Generalizing to $N$-dimensional Hilbert spaces, we can replace
$\setof{\ket{\pm}}$ basis with
\[
  \setof{\ket{a}, a = 0\ldots N-1}
\]
and \eqref{eq:qubit_gen_measurement} with
\begin{equation}\label{eq:gen_measurement}
  U: \ket{\psi}_A \ox \ket{0}_B \rightarrow \sum_a M_a\ket{\psi}_A \ox \ket{a}_B
  \,\text{.}
\end{equation}

So, let's define
\[
  E_a = M^{\dagger}M \,\text{.}
\]

\citereset
All the following holds \parencite[sec.3.1]{PreskillNotes}:
\begin{enumerate}
  \item 
    Hermiticity: \[E_a = E_a^{\dagger}\,\text{;}\]
  \item
    \term{Positivity}: \[\expval{E_a}{\psi} \geq 0\,\text{;}\]  
  \item\label{listitem:POVM}
    Decomposition of the identity (\term{completeness}):
    \begin{equation}\label{eq:POVM}
      \sum_a E_a = \sum_a M_a^{\dagger}M_a = \idop \,\text{;}
    \end{equation}
  \item
    Probability of outcome $a$ of a measurement:
    \[\Pr(a) = \norm{M_a\ket{\psi}}^2 = \expval{E_a}{\psi}\,\text{;}\]
  \item
    Probability of obtaining $b$ in a second measurement:
    \[\Pr(b|a) = \frac{\norm{M_bM_a\ket{\psi}}^2}{\norm{M_a\ket{\psi}}^2}\]
    (would be $\delta_{ab}$ if orthogonal);
  \item
    Probability of outcome, density operator form:
    \[\Pr(a) = \tr(\rho E_a)\,\text{,}\]
    also valid for mixed states.
\end{enumerate}

This partition of the identity by positive operators
as expressed in \eqref{eq:POVM} is called
\term{positive operator-valued measure}, or \term{POVM}.
It generalises the \term{projector-valued measure} (PVM)
found in Von Neumann's theory.

For the sake if simplicity, we're referring to the finite dimensional case,
but the above can be extended to infinite dimensions and continuous spectra,
where the decomposition of the identity can be expressed as
$\int_{-\infty}^{\infty} dx M^{\dagger}(x)M(x) = \idop $.
A more abstract and general definition of POVM is as
follows:\footnote{
  See e.g. \cite{BeneduciPhD, Berberian} --- the level of generalization may vary.
}
\begin{definition}
  Given a (Borel) $\sigma$-algebra $\mathcal{B}(\mathbb{R})$ of subsets of $\mathbb{R}$,
  and the space $\mathcal{F}(\hilb{H})$ of positive, self-adjoint operators on a Hilbert space,
  a \term{positive operator-valued measure} (\term{POVM})
  is a map $E: \mathcal{B}(\mathbb{R}) \rightarrow \mathcal{F}(\hilb{H})$
  such that
  \begin{itemize}
    \item $E(\mathbb{R}) = \idop$ (completeness)
    \item $E\qty(\bigcup\limits_{n} \Delta_n) = \sum\limits_{n} E\qty(\Delta_n)$ (additivity) 
  \end{itemize}
  where $\setof{\Delta_n}$ is a countable family of disjoint sets in
  $\mathcal{B}(\mathbb{R})$.
\end{definition}

\citereset
It's worth noting that,
given a POVM $E$, operators $M$
suitable for \eqref{eq:POVM} and \eqref{eq:gen_measurement}
and following generalization
can always be found \parencite[sec.3.1]{PreskillNotes},
but not uniquely, in the sense that
$UM$ are also valid
for any unitary operator $U$.

Therefore, this formulation leaves the state after a measurement
with outcome $a$
\[
  \frac{M_a\ket{\psi}}{\norm{M_a\ket{\psi}}^2}
  \leftrightarrow
  \frac{UM_a\ket{\psi}}{\norm{M_a\ket{\psi}}^2}
\]
in fact \emph{undetermined}.
