\begin{lstlisting}

Page-Wootters model: NN-level clock + 2-level system



In[2]:= NN= 32

Out[2]= 32



In[3]:= T := DiagonalMatrix[Range[0,NN-1]]

In[4]:= MatrixForm[T]
(suppressed)


In[5]:= F := FourierMatrix[NN]

In[6]:= \[CapitalOmega] := F.T.F\[ConjugateTranspose] 

In[7]:= 


Hamiltonian in "ordinary" space

In[8]:= Hs := \[ImaginaryI]{{0,1},{-1,0}}

In[9]:= MatrixForm[Hs]

(suppressed)


Matrix representation of eq. (1) in https://arxiv.org/abs/1504.04215 by Lloyd, Giovannetti and Maccone.
We turn it into numeric as treating  it symbolically onwards would be unfeasible.

In[10]:= J := N[KroneckerProduct[\[CapitalOmega],IdentityMatrix[2]] + KroneckerProduct[IdentityMatrix[NN],Hs]]

In[11]:= 

In[12]:= Chop[Eigenvalues[J]]

Out[12]= {32.,31.,30.,30.,29.,29.,28.,28.,27.,27.,26.,26.,25.,25.,24.,24.,23.,23.,22.,22.,21.,21.,20.,20.,19.,19.,18.,18.,17.,17.,16.,16.,15.,15.,14.,14.,13.,13.,12.,12.,11.,11.,10.,10.,9.,9.,8.,8.,7.,7.,6.,6.,5.,5.,4.,4.,3.,3.,2.,2.,1.,1.,-1.,0}

In[13]:= chosenEigenvector := Eigenvectors[J][[ 40]]

chosenEigenvectorB := Eigenvectors[J][[41]]

chosenProbUnnormalized := Abs[chosenEigenvector^2]
chosenProbUnnormalizedB := Abs[chosenEigenvectorB^2]

In[17]:= Normalization := chosenProbUnnormalized[[1]] + chosenProbUnnormalized[[2]]

In[18]:= NormalizationB := chosenProbUnnormalizedB[[1]] + chosenProbUnnormalizedB[[2]]

In[19]:= probability := chosenProbUnnormalized / Normalization

In[20]:= probabilityB := chosenProbUnnormalizedB/ NormalizationB

In[21]:= probability

Out[21]= {0.716702,0.283298,0.771924,0.228076,0.785749,0.214251,0.756071,0.243929,0.687408,0.312592,0.590214,0.409786,0.479286,0.520714,0.371512,0.628488,0.283298,0.716702,0.228076,0.771924,0.214251,0.785749,0.243929,0.756071,0.312592,0.687408,0.409786,0.590214,0.520714,0.479286,0.628488,0.371512,0.716702,0.283298,0.771924,0.228076,0.785749,0.214251,0.756071,0.243929,0.687408,0.312592,0.590214,0.409786,0.479286,0.520714,0.371512,0.628488,0.283298,0.716702,0.228076,0.771924,0.214251,0.785749,0.243929,0.756071,0.312592,0.687408,0.409786,0.590214,0.520714,0.479286,0.628488,0.371512}

In[22]:= probabilityB

Out[22]= {0.881533,0.118467,0.744511,0.255489,0.570264,0.429736,0.38532,0.61468,0.217835,0.782165,0.0933066,0.906693,0.0306941,0.969306,0.0395291,0.960471,0.118467,0.881533,0.255489,0.744511,0.429736,0.570264,0.61468,0.38532,0.782165,0.217835,0.906693,0.0933066,0.969306,0.0306941,0.960471,0.0395291,0.881533,0.118467,0.744511,0.255489,0.570264,0.429736,0.38532,0.61468,0.217835,0.782165,0.0933066,0.906693,0.0306941,0.969306,0.0395291,0.960471,0.118467,0.881533,0.255489,0.744511,0.429736,0.570264,0.61468,0.38532,0.782165,0.217835,0.906693,0.0933066,0.969306,0.0306941,0.960471,0.0395291}

In[28]:= ListPlot[probability, GridLines ->{Range[0,NN*2, 2], Range[0,1,0.1]}, ImageSize->Large]
(suooressed)


In[29]:= ListPlot[probabilityB, GridLines ->{Range[0,NN*2, 2], Range[0,1,0.1]}, ImageSize->Large]

(suppressed)

\end{lstlisting}